# This configuration is not right! It's not secure at all!
# TODO: update the cofiguration!
---
- name: MySQL Configuration - copy my.cnf configuration for root user.
  template:
    src: "../templates/root.my.cnf.j2"
    dest: "/root/.my.cnf"
    owner: root
    group: root
    mode: 0644
  notify:
    - Restart MySQL

- name: MySQL Configuration - update `bind-address` setting
  lineinfile:
    path: "/etc/mysql/mysql.conf.d/mysqld.cnf"
    regexp: '^#?\s*bind-address\s+=\s+.+'
    line: "bind-address = {{ mysql_config.bind_address }}"
    state: present
  notify:
    - Restart MySQL

- name: MySQL Configuration - update `mysqlx-bind-address` setting 
  lineinfile:
    path: "/etc/mysql/mysql.conf.d/mysqld.cnf"
    regexp: '^#?\s*mysqlx-bind-address\s+=\s+.+'
    line: "mysqlx-bind-address = {{ mysql_config.bind_address }}"
    state: present
  notify:
    - Restart MySQL